/**
 * wacp-frontend.js
 *
 * @author Your Inspiration Themes
 * @package YITH WooCommerce Added to Cart Popup
 * @version 1.0.0
 */
jQuery(document).ready(function(t){"use strict";if("undefined"!=typeof yith_wacp){var e=t("#yith-wacp-popup"),a=e.find(".yith-wacp-overlay"),n=e.find(".yith-wacp-close"),i=function(){t("html").removeClass("yith_wacp_open"),e.removeClass("open"),setTimeout(function(){e.find(".yith-wacp-content").html("")},1e3),t(document).trigger("yith_wacp_popup_after_closing")},r=function(){var a=e.find(".yith-wacp-wrapper"),n=t(window).width(),i=t(window).height(),r=n-60>yith_wacp.popup_size.width?yith_wacp.popup_size.width:n-60,o=i-120>yith_wacp.popup_size.height?yith_wacp.popup_size.height:i-120;a.css({left:n/2-r/2,top:i/2-o/2,width:r+"px",height:o+"px"})};t(window).on("resize yith_wacp_popup_changed",r),t("body").on("added_to_cart wacp_single_added_to_cart",function(a,n,c,s){"undefined"==typeof n&&(n=t.parseJSON(sessionStorage.getItem(wc_cart_fragments_params.fragment_name))),t.each(n,function(a,n){return"yith_wacp_message"==a?(t(document).trigger("yith_wacp_popup_before_opening",[e]),e.find(".yith-wacp-content").html(n),o(),r(),"undefined"!=typeof t.fn.perfectScrollbar&&e.find(".yith-wacp-content").perfectScrollbar({suppressScrollX:!0}),yith_wacp.is_mobile&&t("html").addClass("yith_wacp_open"),e.addClass("open"),e.find("a.continue-shopping").on("click",function(e){"#"==t(this).attr("href")&&(e.preventDefault(),i())}),t(document).trigger("yith_wacp_popup_after_opening",[e]),!1):void 0})}),a.on("click",i),n.on("click",function(t){t.preventDefault(),i()});var o=function(){t(".yith-wacp-remove-cart").off("click").on("click",function(e){e.preventDefault();var a=t(this).parents("table"),n={action:yith_wacp.actionremove,item_key:t(this).data("item_key"),context:"frontend"};a.block({message:null,overlayCSS:{background:"#fff url("+yith_wacp.loader+") no-repeat center",opacity:.5,cursor:"none"}}),t.ajax({url:yith_wacp.ajaxurl.toString().replace("%%endpoint%%",yith_wacp.actionremove),data:n,dataType:"json",success:function(e){t(".yith-wacp-content table.cart-list").replaceWith(t(e.html).filter("table.cart-list")),t(".yith-wacp-content div.cart-info").replaceWith(t(e.html).filter("div.cart-info")),o(),t(window).trigger("yith_wacp_popup_changed")}})})},c=t("div.summary form.cart, div.summary form.bundle_form");c.length||(c=t("div.product-box form.cart, #product-box form.cart")),c.on("submit",function(e){if("undefined"!=typeof wc_cart_fragments_params&&yith_wacp.enable_single){var a=t(this),n=a.find('button[type="submit"]'),i=a.find('input[name="yith-wacp-is-excluded"]');if(!i.length){e.preventDefault(),t(document).trigger("yith_wacp_adding_cart_single"),n.addClass("loading").removeClass("added");var r=a.serializeArray();r.push({name:"action",value:yith_wacp.actionadd},{name:"context",value:"frontend"}),t.ajax({url:yith_wacp.ajaxurl.toString().replace("%%endpoint%%",yith_wacp.actionadd),data:t.param(r),dataType:"json",type:"POST",success:function(e){if(e.msg)return a.parents("div.product").before(e.msg),t("body").animate({scrollTop:0},500),n.removeAttr("disabled").removeClass("loading"),!1;var i,r,o={product_id:e.prod_id,variation_id:e.variation_id,ywacp_is_single:"yes",context:"frontend"};try{i="sessionStorage"in window&&null!==window.sessionStorage,window.sessionStorage.setItem("wc","test"),window.sessionStorage.removeItem("wc")}catch(c){i=!1}"undefined"!=typeof wc_cart_fragments_params.wc_ajax_url?r=wc_cart_fragments_params.wc_ajax_url.toString().replace("%%endpoint%%","get_refreshed_fragments"):(r=wc_cart_fragments_params.ajax_url,o.action="woocommerce_get_refreshed_fragments"),t.ajax({url:r,type:"POST",data:o,success:function(e){e&&e.fragments&&(t.each(e.fragments,function(e,a){t(e).replaceWith(a)}),i&&(sessionStorage.setItem(wc_cart_fragments_params.fragment_name,JSON.stringify(e.fragments)),sessionStorage.setItem("wc_cart_hash",e.cart_hash)),t("body").trigger("wc_fragments_refreshed").trigger("wacp_single_added_to_cart"),n.removeAttr("disabled").removeClass("loading").addClass("added"))}})}})}}})}});